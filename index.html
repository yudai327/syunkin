<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>瞬勤 (Shunkin) - Instant Shift</title>
    <meta name="description" content="Click & Drag Shift Scheduler">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <script src="lucide.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo-area">
                <i data-lucide="zap" class="logo-icon"></i>
                <h1 class="app-title">瞬勤 <span class="app-subtitle">Shunkin</span></h1>
                <button id="btn-help" class="btn btn-icon btn-sm btn-ghost" title="使い方" style="margin-left: 8px;">
                    <i data-lucide="help-circle"></i>
                </button>
            </div>

            <div class="header-controls">
                <div class="control-group">
                    <label for="month-picker">対象月</label>
                    <div class="month-nav" style="display: flex; align-items: center; gap: 4px;">
                        <button id="btn-prev-month" class="btn btn-icon btn-sm btn-ghost" title="前月">
                            <i data-lucide="chevron-left"></i>
                        </button>
                        <input type="month" id="month-picker" class="input-month">
                        <button id="btn-next-month" class="btn btn-icon btn-sm btn-ghost" title="翌月">
                            <i data-lucide="chevron-right"></i>
                        </button>
                    </div>
                </div>
                <div class="control-group">
                    <div class="view-toggle">
                        <button id="btn-view-cal" class="btn btn-sm btn-primary" title="カレンダー表示">
                            <i data-lucide="calendar"></i>
                        </button>
                        <button id="btn-view-timeline" class="btn btn-sm btn-secondary" title="タイムライン表示">
                            <i data-lucide="table-2"></i>
                        </button>
                    </div>
                </div>

                <div class="action-buttons">
                    <div class="control-group">
                        <label for="optimization-strength">最適化:</label>
                        <select id="optimization-strength" class="select-strength">
                            <option value="weak">弱 (速)</option>
                            <option value="medium" selected>中 (標準)</option>
                            <option value="strong">強 (精密)</option>
                            <option value="strongest">最強 (10倍)</option>
                        </select>
                    </div>
                    <button id="btn-generate" class="btn btn-primary">
                        <i data-lucide="sparkles"></i> 自動生成
                    </button>
                    <button id="btn-reset" class="btn btn-secondary">
                        <i data-lucide="rotate-ccw"></i> リセット
                    </button>
                    <button id="btn-print" class="btn btn-ghost">
                        <i data-lucide="printer"></i> 印刷
                    </button>
                    <button id="btn-export" class="btn btn-ghost icon-only" title="Export JSON">
                        <i data-lucide="download"></i>
                    </button>
                    <button id="btn-import" class="btn btn-ghost icon-only" title="Import JSON">
                        <i data-lucide="upload"></i>
                    </button>
                    <input type="file" id="file-import" accept=".json" style="display: none;">
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-layout">

            <!-- Sidebar: Members & Settings -->
            <aside class="sidebar">
                <!-- Team Section -->
                <div class="sidebar-section">
                    <div class="section-header">
                        <h2>チーム</h2>
                        <div class="header-actions">
                            <button id="btn-add-team" class="btn btn-sm btn-outline" title="チーム追加">
                                <i data-lucide="plus"></i>
                            </button>
                            <button id="btn-edit-team" class="btn btn-sm btn-ghost" title="チーム名変更">
                                <i data-lucide="edit-2"></i>
                            </button>
                            <button id="btn-delete-team" class="btn btn-sm btn-ghost text-danger" title="チーム削除">
                                <i data-lucide="trash-2"></i>
                            </button>
                        </div>
                    </div>
                    <div style="width: 100%; margin-top: 8px;">
                        <select id="team-select" class="input-full"
                            style="width: 100%; font-size: 1.3rem; font-weight: bold; height: 56px;">
                            <option value="ALL">チーム全体</option>
                        </select>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="section-header">
                        <h2>メンバー</h2>
                        <button id="btn-add-member" class="btn btn-sm btn-outline">
                            <i data-lucide="plus"></i> 追加
                        </button>
                    </div>
                    <div id="member-list" class="member-list">
                        <!-- Member items will be injected here -->
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="section-header">
                        <h2>設定・集計</h2>
                    </div>
                    <div class="settings-card"
                        style="margin-bottom: 12px; padding: 12px; background: #fff; border-radius: 8px; border: 1px solid var(--border);">
                        <div class="control-group" style="margin-bottom: 8px;">
                            <label for="setting-base-off" style="font-size: 0.85rem; font-weight: bold;">月間公休数</label>
                            <input type="number" id="setting-base-off" class="input-sm" value="8" min="0" max="31"
                                style="width: 50px; padding: 6px; font-size: 1rem; border: 1px solid var(--border); border-radius: 4px;">
                        </div>
                        <div class="control-group">
                            <label for="setting-max-consecutive"
                                style="font-size: 0.85rem; font-weight: bold;">最大連勤数</label>
                            <input type="number" id="setting-max-consecutive" class="input-sm" value="5" min="1"
                                max="14"
                                style="width: 50px; padding: 6px; font-size: 1rem; border: 1px solid var(--border); border-radius: 4px;">
                        </div>
                    </div>

                    <div class="stats-card">
                        <div class="stat-item">
                            <span class="stat-label">稼働日数</span>
                            <span class="stat-value" id="stat-workdays">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">総出勤枠</span>
                            <span class="stat-value" id="stat-total-slots">0</span>
                        </div>
                    </div>

                    <div class="settings-form">
                        <h4>曜日設定</h4>
                        <div class="weekday-settings-grid">
                            <div class="weekday-setting">
                                <label>月</label>
                                <select id="day-mon">
                                    <option value="WORK">稼働日</option>
                                    <option value="OFF">休日</option>
                                    <option value="HALF_AM">AM休</option>
                                    <option value="HALF_PM">PM休</option>
                                </select>
                            </div>
                            <div class="weekday-setting">
                                <label>火</label>
                                <select id="day-tue">
                                    <option value="WORK">稼働日</option>
                                    <option value="OFF">休日</option>
                                    <option value="HALF_AM">AM休</option>
                                    <option value="HALF_PM">PM休</option>
                                </select>
                            </div>
                            <div class="weekday-setting">
                                <label>水</label>
                                <select id="day-wed">
                                    <option value="WORK">稼働日</option>
                                    <option value="OFF">休日</option>
                                    <option value="HALF_AM">AM休</option>
                                    <option value="HALF_PM">PM休</option>
                                </select>
                            </div>
                            <div class="weekday-setting">
                                <label>木</label>
                                <select id="day-thu">
                                    <option value="WORK">稼働日</option>
                                    <option value="OFF">休日</option>
                                    <option value="HALF_AM">AM休</option>
                                    <option value="HALF_PM">PM休</option>
                                </select>
                            </div>
                            <div class="weekday-setting">
                                <label>金</label>
                                <select id="day-fri">
                                    <option value="WORK">稼働日</option>
                                    <option value="OFF">休日</option>
                                    <option value="HALF_AM">AM休</option>
                                    <option value="HALF_PM">PM休</option>
                                </select>
                            </div>
                            <div class="weekday-setting">
                                <label style="color:var(--color-sat)">土</label>
                                <select id="day-sat">
                                    <option value="WORK">稼働日</option>
                                    <option value="OFF" selected>休日</option>
                                    <option value="HALF_AM">AM休</option>
                                    <option value="HALF_PM">PM休</option>
                                </select>
                            </div>
                            <div class="weekday-setting">
                                <label style="color:var(--color-sun)">日</label>
                                <select id="day-sun">
                                    <option value="WORK">稼働日</option>
                                    <option value="OFF" selected>休日</option>
                                    <option value="HALF_AM">AM休</option>
                                    <option value="HALF_PM">PM休</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Calendar Area -->
            <section class="calendar-area">
                <div class="calendar-header-row">
                    <div class="cal-col-header">月</div>
                    <div class="cal-col-header">火</div>
                    <div class="cal-col-header">水</div>
                    <div class="cal-col-header">木</div>
                    <div class="cal-col-header">金</div>
                    <div class="cal-col-header sat">土</div>
                    <div class="cal-col-header sun">日</div>
                </div>

                <div id="calendar-grid" class="calendar-grid">
                    <!-- Calendar days will be injected here -->
                </div>
            </section>

            <!-- Timeline Area -->
            <section id="timeline-container" class="timeline-container" style="display: none;">
                <!-- Timeline content will be injected here -->
            </section>

        </main>
    </div>

    <!-- Print Layout (Invisible on screen) -->
    <div id="print-area" class="print-area">
        <!-- Print content injected here -->
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>使い方</h2>
                <button id="btn-close-help" class="btn btn-ghost btn-sm"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="step-item">
                    <div class="step-num">1</div>
                    <div class="step-desc">
                        <strong>設定</strong>
                        <p>メンバー、休日設定、必要人数を入力または調整します。</p>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-num">2</div>
                    <div class="step-desc">
                        <strong>生成</strong>
                        <p>「自動生成」ボタンをクリックしてシフトを作成します。</p>
                    </div>
                </div>
                <div class="step-item">
                    <div class="step-num">3</div>
                    <div class="step-desc">
                        <strong>調整</strong>
                        <p>クリックで修正、右クリックでロック。最後に「印刷」します。</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-close-help-main" class="btn btn-primary">閉じる</button>
            </div>
        </div>
    </div>

    <!-- Progress Modal -->
    <div id="progress-modal" class="modal-overlay" style="display: none; background: rgba(0,0,0,0.5); z-index: 1000;">
        <div class="modal-content" style="max-width: 300px; text-align: center; padding: 24px;">
            <h3 style="margin-top: 0; margin-bottom: 16px;">自動生成中...</h3>
            <div
                style="background: #e2e8f0; border-radius: 999px; height: 12px; width: 100%; overflow: hidden; margin-bottom: 8px;">
                <div id="progress-bar"
                    style="background: var(--primary); width: 0%; height: 100%; transition: width 0.1s;"></div>
            </div>
            <p id="progress-text" style="font-size: 0.9rem; color: #64748b; margin: 0;">0%</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>

</html>